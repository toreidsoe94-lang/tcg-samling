<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Min TCG Samling</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root{--bg-dark:#0a0a0f;--bg-card:#12121a;--bg-card-hover:#1a1a25;--accent-pokemon:#f6c700;--accent-magic:#9b4dca;--accent-digimon:#0095d9;--accent-singles-pokemon:#ee5050;--accent-singles-magic:#4a90d9;--accent-wishlist:#00d4aa;--text-primary:#fff;--text-secondary:#8a8a9a;--text-muted:#5a5a6a;--border-color:#2a2a3a}*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Outfit',sans-serif;background:var(--bg-dark);color:var(--text-primary);min-height:100vh;line-height:1.6}body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(ellipse at 20% 10%,rgba(246,199,0,.04) 0%,transparent 50%),radial-gradient(ellipse at 80% 90%,rgba(155,77,202,.04) 0%,transparent 50%);pointer-events:none}header{padding:2.5rem 2rem;text-align:center;border-bottom:1px solid var(--border-color);background:linear-gradient(180deg,rgba(246,199,0,.06) 0%,transparent 100%)}header h1{font-size:2.5rem;font-weight:800;background:linear-gradient(135deg,#fff 0%,#aaa 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:.25rem}header p{color:var(--text-secondary);font-size:.95rem}.container{max-width:1600px;margin:0 auto;padding:2rem;position:relative}.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:1rem;margin-bottom:2rem}.stat-card{background:var(--bg-card);border:1px solid var(--border-color);border-radius:16px;padding:1.25rem;text-align:center;transition:all .2s}.stat-card:hover{transform:translateY(-2px);border-color:rgba(246,199,0,.3)}.stat-value{font-family:'Space Mono',monospace;font-size:1.75rem;font-weight:700;color:var(--accent-pokemon)}.stat-label{color:var(--text-secondary);font-size:.75rem;text-transform:uppercase;letter-spacing:.1em;margin-top:.25rem}.action-bar{display:flex;gap:.75rem;margin-bottom:2rem;flex-wrap:wrap}.btn{font-family:'Outfit',sans-serif;padding:.7rem 1.2rem;border:none;border-radius:10px;font-size:.875rem;font-weight:600;cursor:pointer;display:inline-flex;align-items:center;gap:.5rem;transition:all .2s}.btn-primary{background:linear-gradient(135deg,#f6c700,#ff6b35);color:#000}.btn-primary:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(246,199,0,.25)}.btn-secondary{background:var(--bg-card);color:var(--text-primary);border:1px solid var(--border-color)}.btn-secondary:hover{border-color:var(--accent-pokemon)}.btn-wishlist{background:linear-gradient(135deg,#00d4aa,#00a8cc);color:#000}.btn-wishlist:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,212,170,.25)}.tabs{display:flex;gap:.5rem;margin-bottom:2rem;flex-wrap:wrap;border-bottom:1px solid var(--border-color);padding-bottom:1rem}.tab{padding:.6rem 1.1rem;background:0 0;border:1px solid transparent;border-radius:8px;color:var(--text-secondary);font-family:'Outfit',sans-serif;font-size:.85rem;font-weight:500;cursor:pointer;transition:all .2s}.tab:hover{color:var(--text-primary);background:var(--bg-card)}.tab-icon{width:18px;height:18px;vertical-align:middle;margin-right:4px;border-radius:3px;object-fit:contain}.tab.active{background:var(--bg-card);border-color:var(--border-color)}.tab.active.pokemon{border-color:var(--accent-pokemon);color:var(--accent-pokemon)}.tab.active.magic{border-color:var(--accent-magic);color:var(--accent-magic)}.tab.active.digimon{border-color:var(--accent-digimon);color:var(--accent-digimon)}.tab.active.pokemon-singles{border-color:var(--accent-singles-pokemon);color:var(--accent-singles-pokemon)}.tab.active.magic-singles{border-color:var(--accent-singles-magic);color:var(--accent-singles-magic)}.tab.active.wishlist{border-color:var(--accent-wishlist);color:var(--accent-wishlist)}.tcg-section{display:none;animation:fadeIn .3s ease}.tcg-section.active{display:block}@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.type-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1.25rem}.type-card{background:var(--bg-card);border:1px solid var(--border-color);border-radius:14px;padding:1.5rem;text-align:center;cursor:pointer;transition:all .25s;position:relative;overflow:hidden}.type-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--accent-pokemon),#ff6b35);transform:scaleX(0);transition:transform .3s}.type-card:hover{transform:translateY(-4px);border-color:var(--accent-pokemon);box-shadow:0 8px 30px rgba(246,199,0,.1)}.type-card:hover::before{transform:scaleX(1)}.type-card.magic::before{background:linear-gradient(90deg,var(--accent-magic),#667eea)}.type-card.magic:hover{border-color:var(--accent-magic);box-shadow:0 8px 30px rgba(155,77,202,.1)}.type-card.digimon::before{background:linear-gradient(90deg,var(--accent-digimon),#00c3ff)}.type-card.digimon:hover{border-color:var(--accent-digimon);box-shadow:0 8px 30px rgba(0,149,217,.1)}.type-icon{font-family:'Space Mono',monospace;font-size:.7rem;font-weight:700;color:var(--accent-pokemon);background:rgba(246,199,0,.1);padding:.4rem .8rem;border-radius:6px;display:inline-block;margin-bottom:.75rem;letter-spacing:.05em}.type-card.magic .type-icon{color:var(--accent-magic);background:rgba(155,77,202,.1)}.type-card.digimon .type-icon{color:var(--accent-digimon);background:rgba(0,149,217,.1)}.type-name{font-size:1.1rem;font-weight:600;margin-bottom:.25rem}.type-count{color:var(--text-secondary);font-size:.85rem}.product-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:1.25rem}.product-card{background:var(--bg-card);border:1px solid var(--border-color);border-radius:14px;overflow:hidden;transition:all .25s}.product-card:hover{transform:translateY(-4px);border-color:var(--accent-pokemon);box-shadow:0 12px 40px rgba(0,0,0,.3)}.product-card.magic:hover{border-color:var(--accent-magic)}.product-card.digimon:hover{border-color:var(--accent-digimon)}.product-card.pokemon-single:hover{border-color:var(--accent-singles-pokemon)}.product-image-container{position:relative;height:180px;background:linear-gradient(145deg,#1a1a25,#0d0d12);display:flex;align-items:center;justify-content:center}.product-card.pokemon-single .product-image-container,.product-card.magic-single .product-image-container{height:320px}.product-image{max-width:85%;max-height:160px;object-fit:contain;transition:transform .3s}.product-card:hover .product-image{transform:scale(1.05)}.product-card.pokemon-single .product-image,.product-card.magic-single .product-image{max-height:300px}.product-badge{position:absolute;top:.75rem;right:.75rem;background:var(--accent-pokemon);color:#000;font-family:'Space Mono',monospace;font-size:.7rem;font-weight:700;padding:.25rem .6rem;border-radius:5px}.product-badge.magic{background:var(--accent-magic);color:#fff}.product-badge.digimon{background:var(--accent-digimon);color:#fff}.product-badge.pokemon-single{background:var(--accent-singles-pokemon);color:#fff}.product-badge.magic-single{background:var(--accent-singles-magic);color:#fff}.product-badge.wishlist{background:var(--accent-wishlist);color:#000}.product-content{padding:1.25rem}.product-generation{font-size:.7rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.1em;margin-bottom:.4rem}.product-name{font-size:1rem;font-weight:600;margin-bottom:.2rem;line-height:1.3}.product-subtitle{color:var(--text-secondary);font-size:.85rem;margin-bottom:.75rem}.product-note{background:rgba(246,199,0,.1);color:var(--accent-pokemon);padding:.4rem .6rem;border-radius:6px;font-size:.8rem;margin-bottom:.75rem;display:inline-block}.product-meta{display:flex;justify-content:space-between;align-items:center;padding-top:.75rem;border-top:1px solid var(--border-color)}.product-quantity{font-family:'Space Mono',monospace;font-size:.8rem;color:var(--text-secondary)}.product-value{font-family:'Space Mono',monospace;font-size:.85rem;color:var(--accent-pokemon);font-weight:600}.price-links{display:flex;gap:.4rem;margin-top:.6rem;flex-wrap:wrap}.price-link{font-size:.7rem;color:var(--text-muted);text-decoration:none;padding:.2rem .5rem;background:var(--bg-card-hover);border-radius:4px;transition:all .2s}.price-link:hover{color:var(--accent-pokemon);background:rgba(246,199,0,.1)}.product-actions{display:flex;gap:.4rem;margin-top:.75rem;flex-wrap:wrap}.btn-small{padding:.35rem .6rem;font-size:.75rem;border-radius:5px;background:var(--bg-card-hover);border:1px solid var(--border-color);color:var(--text-secondary);cursor:pointer;transition:all .2s;font-family:'Outfit',sans-serif}.btn-small:hover{border-color:var(--accent-pokemon);color:var(--accent-pokemon)}.btn-small.delete:hover{border-color:#ff4757;color:#ff4757}.back-btn{display:inline-flex;align-items:center;gap:.4rem;color:var(--text-secondary);font-size:.9rem;cursor:pointer;margin-bottom:1.25rem;background:0 0;border:none;font-family:'Outfit',sans-serif;transition:all .2s}.back-btn:hover{color:var(--accent-pokemon);transform:translateX(-4px)}.generation-header{font-size:1rem;font-weight:600;color:var(--text-secondary);margin:1.5rem 0 1rem;padding-bottom:.6rem;border-bottom:1px solid var(--border-color);grid-column:1/-1}.generation-header:first-child{margin-top:0}.empty-state{text-align:center;padding:4rem 2rem;color:var(--text-secondary)}.empty-state-icon{font-size:3.5rem;margin-bottom:1rem;opacity:.5}.empty-state-text{font-size:1rem;margin-bottom:1.5rem}.modal-overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.85);backdrop-filter:blur(8px);z-index:1000;align-items:center;justify-content:center;padding:1rem}.modal-overlay.active{display:flex}.modal{background:var(--bg-card);border:1px solid var(--border-color);border-radius:20px;width:100%;max-width:550px;max-height:90vh;overflow-y:auto;animation:modalIn .3s ease}@keyframes modalIn{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.modal-header{padding:1.25rem 1.5rem;border-bottom:1px solid var(--border-color);display:flex;justify-content:space-between;align-items:center}.modal-header h2{font-size:1.25rem;font-weight:700}.modal-close{background:0 0;border:none;color:var(--text-secondary);font-size:1.5rem;cursor:pointer;transition:color .2s;width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:8px}.modal-close:hover{color:var(--text-primary);background:var(--bg-card-hover)}.modal-body{padding:1.5rem}.form-group{margin-bottom:1.25rem}.form-label{display:block;font-size:.85rem;font-weight:500;color:var(--text-secondary);margin-bottom:.4rem}.form-input,.form-select,.form-textarea{width:100%;padding:.75rem 1rem;background:var(--bg-dark);border:1px solid var(--border-color);border-radius:10px;color:var(--text-primary);font-family:'Outfit',sans-serif;font-size:.95rem;transition:all .2s}.form-input:focus,.form-select:focus,.form-textarea:focus{outline:0;border-color:var(--accent-pokemon);box-shadow:0 0 0 3px rgba(246,199,0,.1)}.form-textarea{min-height:80px;resize:vertical}.form-row{display:grid;grid-template-columns:1fr 1fr;gap:1rem}.modal-footer{padding:1.25rem 1.5rem;border-top:1px solid var(--border-color);display:flex;gap:.75rem;justify-content:flex-end}.checkbox-group{display:flex;align-items:center;gap:.6rem;cursor:pointer}.checkbox-input{width:20px;height:20px;accent-color:var(--accent-wishlist);cursor:pointer}.digimon-logo-container{width:100px;height:60px;display:flex;align-items:center;justify-content:center}.lightbox-overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.92);backdrop-filter:blur(12px);z-index:2000;align-items:center;justify-content:center;padding:1rem;overflow-y:auto}.lightbox-overlay.active{display:flex}.lightbox-container{background:var(--bg-card);border:1px solid var(--border-color);border-radius:20px;width:100%;max-width:600px;max-height:95vh;overflow-y:auto;animation:lightboxIn .3s ease;position:relative}@keyframes lightboxIn{from{opacity:0;transform:scale(.9)}to{opacity:1;transform:scale(1)}}.lightbox-close{position:absolute;top:1rem;right:1rem;background:var(--bg-dark);border:1px solid var(--border-color);color:var(--text-primary);font-size:1.5rem;width:44px;height:44px;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s;z-index:10}.lightbox-close:hover{background:var(--accent-pokemon);color:#000;border-color:var(--accent-pokemon)}.lightbox-image-section{position:relative;background:linear-gradient(145deg,#1a1a25,#0d0d12);padding:2rem;display:flex;align-items:center;justify-content:center;min-height:300px;border-radius:20px 20px 0 0}.lightbox-image{max-width:100%;max-height:400px;object-fit:contain;border-radius:8px}.lightbox-badge{position:absolute;top:1rem;left:1rem;background:var(--accent-pokemon);color:#000;font-family:'Space Mono',monospace;font-size:.85rem;font-weight:700;padding:.4rem .8rem;border-radius:8px}.lightbox-badge.magic{background:var(--accent-magic);color:#fff}.lightbox-badge.digimon{background:var(--accent-digimon);color:#fff}.lightbox-info{padding:1.5rem}.lightbox-header{margin-bottom:1rem}.lightbox-generation{font-size:.75rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.1em;margin-bottom:.25rem}.lightbox-name{font-size:1.5rem;font-weight:700;margin-bottom:.25rem}.lightbox-subtitle{color:var(--text-secondary);font-size:1rem}.lightbox-meta{display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin:1.25rem 0;padding:1rem;background:var(--bg-dark);border-radius:12px}.lightbox-meta-item{text-align:center}.lightbox-meta-label{font-size:.7rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.05em;margin-bottom:.25rem}.lightbox-meta-value{font-family:'Space Mono',monospace;font-size:1.1rem;font-weight:600;color:var(--accent-pokemon)}.lightbox-description{margin:1.25rem 0}.lightbox-description-label{font-size:.85rem;font-weight:600;color:var(--text-secondary);margin-bottom:.5rem;display:flex;align-items:center;justify-content:space-between}.lightbox-description-edit{background:none;border:none;color:var(--text-muted);cursor:pointer;font-size:.8rem;padding:.25rem .5rem;border-radius:4px;transition:all .2s}.lightbox-description-edit:hover{color:var(--accent-pokemon);background:rgba(246,199,0,.1)}.lightbox-description-text{background:var(--bg-dark);border:1px solid var(--border-color);border-radius:10px;padding:1rem;min-height:80px;color:var(--text-primary);font-size:.9rem;line-height:1.6}.lightbox-description-textarea{width:100%;background:var(--bg-dark);border:1px solid var(--accent-pokemon);border-radius:10px;padding:1rem;min-height:120px;color:var(--text-primary);font-size:.9rem;line-height:1.6;font-family:'Outfit',sans-serif;resize:vertical}.lightbox-description-textarea:focus{outline:none;box-shadow:0 0 0 3px rgba(246,199,0,.2)}.lightbox-description-actions{display:flex;gap:.5rem;margin-top:.75rem}.lightbox-links{display:flex;gap:.5rem;flex-wrap:wrap;margin-top:1rem}.lightbox-link{font-size:.8rem;color:var(--text-secondary);text-decoration:none;padding:.5rem 1rem;background:var(--bg-dark);border:1px solid var(--border-color);border-radius:8px;transition:all .2s}.lightbox-link:hover{color:var(--accent-pokemon);border-color:var(--accent-pokemon);background:rgba(246,199,0,.1)}.lightbox-actions{display:flex;gap:.75rem;margin-top:1.25rem;padding-top:1.25rem;border-top:1px solid var(--border-color)}@media (max-width:768px){header h1{font-size:1.75rem}.container{padding:1rem}.form-row{grid-template-columns:1fr}.product-grid{grid-template-columns:1fr}.action-bar{flex-direction:column}.btn{width:100%;justify-content:center}}
    </style>
</head>
<body>
    <header><h1>Min TCG Samling</h1><p>Hold oversikt over din sealed collection</p></header>
    <div class="container">
        <div class="stats-grid">
            <div class="stat-card"><div class="stat-value" id="totalProducts">0</div><div class="stat-label">Produkter</div></div>
            <div class="stat-card"><div class="stat-value" id="totalItems">0</div><div class="stat-label">Totalt antall</div></div>
            <div class="stat-card"><div class="stat-value" id="totalValue">‚Äî</div><div class="stat-label">Est. Verdi</div></div>
            <div class="stat-card"><div class="stat-value" id="singlesCount">0</div><div class="stat-label">Enkeltkort</div></div>
            <div class="stat-card"><div class="stat-value" id="wishlistCount">0</div><div class="stat-label">√ònskeliste</div></div>
        </div>
        <div class="action-bar">
            <button class="btn btn-primary" onclick="openAddModal()"><span>+</span> Legg til produkt</button>
            <button class="btn btn-wishlist" onclick="openAddModal(true)"><span>‚ô°</span> √ònskeliste</button>
            <button class="btn btn-secondary" onclick="exportData()">‚Üì Eksporter</button>
            <button class="btn btn-secondary" onclick="document.getElementById('importFile').click()">‚Üë Importer</button>
            <input type="file" id="importFile" accept=".json" style="display:none" onchange="importData(event)">
        </div>
        <div class="tabs">
            <button class="tab active pokemon" data-tab="pokemon" onclick="switchTab('pokemon')"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAABAGlDQ1BpY2MAABiVY2BgPMEABCwGDAy5eSVFQe5OChGRUQrsDxgYgRAMEpOLCxhwA6Cqb9cgai/r4lGHC3CmpBYnA+kPQKxSBLQcaKQIkC2SDmFrgNhJELYNiF1eUlACZAeA2EUhQc5AdgqQrZGOxE5CYicXFIHU9wDZNrk5pckIdzPwpOaFBgNpDiCWYShmCGJwZ3AC+R+iJH8RA4PFVwYG5gkIsaSZDAzbWxkYJG4hxFQWMDDwtzAwbDuPEEOESUFiUSJYiAWImdLSGBg+LWdg4I1kYBC+wMDAFQ0LCBxuUwC7zZ0hHwjTGXIYUoEingx5DMkMekCWEYMBgyGDGQCm1j8/yRb+6wAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAACi1BMVEX7+/v9/f38/Pz5+fn+/v719fX4+Pj6+vr29vb8/Pv6+vv////+/fz09PX9/fv+/v39/fr//v3g4OCnqaz09fv9/Pr29/2nqavi4uHn6Ov19PPm5+ofIBi1rGn3+Pr///7+/vv///33+Py9s28fIB7GydXc0o7Ftk/v8PT5+fiZmpXVugnc0Hr3+f/5+//bz4Hdwhdzb0jeyk362hjdzFjs7vr6+vf39/f19v7Wynbv0yPXzpbh1o7h1YvXz5jv1C3WwDHt0y//5jT/5SvUxmj09v////zt7/nVxFX63Sn32SX42SP63i/WvzHo0DH/5y332SflxiPOw477+/j09PTu6sy6ry91ckv/6zb/7jZ4dEu2rDPozzDkzk7azpXh3dX09Pj9/fzZyrLLVxXUuy/EmirDlyrTvSzUYSO/njLm6uH4+Pfr6u7GdEb/6jCxbyitZyb/7zK9aj3XvSbd0oH8/f/8/Pn//vz9///Rz3/12yX44Db33zT43zHGvjvbxkTSyJf7/P/u8PndyUvy1y3r0jPt0zHv1jTlyybFt1Hz9Pzm5d3MuC7z2izjzC3fyTDy2THSvCeyn0jv7eT09vvq8f/X18DfyCu4sEq/tEGVnG67sEPDtTrV0r3+///5+/v7+/ro7fqpqY/PtmGhnnCOlmyto2+VmHiHj3yYl3S/rFyEk6Cgo5Kus67y9Pf7/Pz9/f75+/6Xoqu9qliUk3Wfl2S8p1ejmGGgmGyYkWe9p1eblGfCqU7BsXDv9P/6+/vg5vaIhG+Jin+nooicpK6hp66pscC0vtB6h56ZmZaRiWbHwaf6+vj4+Pm7wM7d4ej4+//5+v39/v77/P34+v/Izd3a3eT+/vz5+frvBxlwAAAAAWJLR0QLH9fEwAAAAAd0SU1FB+oCBQoGN9VltkkAAAGhSURBVBjTY2BgBAImJmYWVjYWdjYmFiYWRiaQGAsDMxsLBxuQ4uQCijKBBFkYGLl5WHmZ2TjY+Lj5BQSZmBlYGBm4hYRF+JgYGRlExcQluCWluBkYmBj4pWVk5eQVFBSVlFVU1dQ1mBmAdmhya2nr6Coq6ukbGBoZm5iaMTAxM5orWlhaWdvY2tk7ODo5u7i6MTCzcLCzyLt7eHp5+/j6+QcEBnEHM7BwhDDyc4eGhUdERkXHxMbFJySyMbCyMTMmciclp6SmpWdkZnEzZrMxMbBxMzOycOfk5uUXFBYVl5SWmTOxMLAwcDBxl1dUVlXX1NbVNzTysQFdzs7MzM7C3dTc0trW3tHZxc3MAPQiGxOjOQN3d09vX/+EiZMmc3OA/AgMFZ4pU6dNnzFz1uw5c+fNXwAKJRYm7oWLFi9Zumz5ipWrVq9Zu457PRMD0wb+jZs2b9m6bfuOnbt279m7r5wLFEr75Q8cPHT4yNFjx0+cPHWa+ww7IzCUmM5ynzt/4eKly9wXr1y9dv0GIysDOCYYuEWz2Rm5mARYgOHDygwAQPBh5Kf987oAAAAedEVYdGljYzpjb3B5cmlnaHQAR29vZ2xlIEluYy4gMjAxNqwLMzgAAAAUdEVYdGljYzpkZXNjcmlwdGlvbgBzUkdCupBzBwAAAABJRU5ErkJggg==" class="tab-icon" alt=""> Pok√©mon</button>
            <button class="tab magic" data-tab="magic" onclick="switchTab('magic')"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAMAAABI111xAAABAGlDQ1BpY2MAABiVY2BgPMEABCwGDAy5eSVFQe5OChGRUQrsDxgYgRAMEpOLCxhwA6Cqb9cgai/r4lGHC3CmpBYnA+kPQKxSBLQcaKQIkC2SDmFrgNhJELYNiF1eUlACZAeA2EUhQc5AdgqQrZGOxE5CYicXFIHU9wDZNrk5pckIdzPwpOaFBgNpDiCWYShmCGJwZ3AC+R+iJH8RA4PFVwYG5gkIsaSZDAzbWxkYJG4hxFQWMDDwtzAwbDuPEEOESUFiUSJYiAWImdLSGBg+LWdg4I1kYBC+wMDAFQ0LCBxuUwC7zZ0hHwjTGXIYUoEingx5DMkMekCWEYMBgyGDGQCm1j8/yRb+6wAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAACl1BMVEUKERkLFR8JFh0FERUGERUEHR5KjnHJ4Kzz78fg4tni49vm9u95v8dZkaxHdpooX4pKmcFYlbpOd5VAXXIHDRMFDREFEBEMIR4PKScpdFhZy5GNwpXK0sNAPz5OTUru8++x6Ol/ythOnsktg7lNvN5OpMtKeqA6VHAGExcEDhECCw4IHBsbUD9StoRhtohej3WkwKd+jXyhpJz5+/rE8vKv//9Uq9ERR4crhr89ns5Nia05XH0JHR8GGRgEEBEFHxstcFE6YEsbKSSPq4jt7MXc/O/p/////vzD6vVlr8Jdt9gXToYMQ4YyjMNw0OVVlrcGFxkDEA8MLCMQOCs7YUYjLScXIBbEsXj916fn8urE7fH4//6s6PYEJC+Vv8mG6/4rk8ccYKBTrs5kvNQGFRcKFhYeOy9KWEBkcUtsfEyYoV75zYj81JD17MGcrL2s4fHU/PufuL2x1+G16/RquNAwX45HjLByxdoUGyEfIyUrIR1eUDuVj1awoEziqlD+m1D6t2z/9rrDsK6Mr8ri///u///K8fXV6fCLqrs7UGJJZXh2p7szKi0xIh49IBl3OymjVzPmkE7uekbncDf5k0z+xZ/Jppt5d3+NnqfIz9OnvceKqLdRaHgVHCQXICkhOlA+LSxCJx5PIhloJRp6IxrWZjvbfU58Oiy6eEn+rojap56Of34QDQpOT1IyPlEQHi0VJDEIDhQDBw0GDhk2JiRFJh5FHRUwEAwmCwmLOCOrXTg7KSLBeFPYgGKPbGhbVVgyMTM4OUEMEx8AAAYBBQwCBgoAAwcHCg4tHR01Gxc9GRIiDAsWCAYvDQi7Ry3sh2PVhGqocWdMQkQWGSEwMkARFB8AAgcCAwcCBAkCBQkBBAgRFhz////ebrhjAAAAAWJLR0TcB2CDtwAAAAd0SU1FB+oCBQoGN9VltkkAAADySURBVAjXAecAGP8AAAECAwQFBgcICQoLDA0ODxAREhMAFBUWFxgZGhscHR4fICEiIyQlJicAKCkqKywtLi8wMTIzNDU2Nzg5OjsAPD0+P0BBQkNERUZHSElKS0xNTk8AUFFSU1RVVldYWVpbXF1eX2BhYmMAZGVmZ2hpamtsbW5vcHFyc3R1dncAeHl6e3x9fn+AgYKDhIWGh4iJiosAjI2Oj5CRkpOUlZaXmJmam5ydnp8AoKGio6SlpqeoqaqrrK2ur7CxsrMAtLW2t7i5uru8vb6/wMHCw8TFxscAyMnKy8zNzs/Q0dLT1NXW19jZ2ttBU14bO13wjwAAAB50RVh0aWNjOmNvcHlyaWdodABHb29nbGUgSW5jLiAyMDE2rAszOAAAABR0RVh0aWNjOmRlc2NyaXB0aW9uAHNSR0K6kHMHAAAAAElFTkSuQmCC" class="tab-icon" alt=""> Magic</button>
            <button class="tab digimon" data-tab="digimon" onclick="switchTab('digimon')"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAABAGlDQ1BpY2MAABiVY2BgPMEABCwGDAy5eSVFQe5OChGRUQrsDxgYgRAMEpOLCxhwA6Cqb9cgai/r4lGHC3CmpBYnA+kPQKxSBLQcaKQIkC2SDmFrgNhJELYNiF1eUlACZAeA2EUhQc5AdgqQrZGOxE5CYicXFIHU9wDZNrk5pckIdzPwpOaFBgNpDiCWYShmCGJwZ3AC+R+iJH8RA4PFVwYG5gkIsaSZDAzbWxkYJG4hxFQWMDDwtzAwbDuPEEOESUFiUSJYiAWImdLSGBg+LWdg4I1kYBC+wMDAFQ0LCBxuUwC7zZ0hHwjTGXIYUoEingx5DMkMekCWEYMBgyGDGQCm1j8/yRb+6wAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABmFBMVEX////+/v7+//////78/P39/f37/Pz8/Pz5/P73+/7//v/9/f64xtByiaBnbXZlaXJrfI+cscL7+vr29vbf5e7h5u/q7PGhtMZBQ1a1WBOwaCasZinRYxFXODFxiqPh5e3n6vDl6fDl6Oz5+fj7+/uGkJo9RzxNV0w0Q0UeMDppTSlzWjMwUlosVF9CPjVkQh8qMy9DT0g0QkU6SUgtPUji5OZjaWmVfyOahjGGdSuVgC+FeDNMTSuQfi6qjS/OqDaNfTKVgTKYgi+Zfy2miChGSkX4+fzy9/1cUkKtaBWOXSCPXh2RYSCoaiN9ThuTXRt0Sxe0cByFWCGkYx6PVxyIWyOyYgxbYmng4+YnMz9UQTcwMzkxMzgdIy5sQSZYQzAwRVMKMU87MzJcNRpCLCYsMDcvNT4mJCuIkJf5+fnf4+fV4erc4+nh5+yXqbk5P0mrYhukaS+mbTPCbx1XPjBphJvc4+fg5uvZ4ujz8/T9/v62wsxqeIhjYWFgXV5qcXuVo7D6+vr2+v3z+P38/f3//v77+/z+/v8VNkobAAAAAWJLR0QAiAUdSAAAAAd0SU1FB+oCBQoGNqJiht8AAADeSURBVBjTY2CgDmAEAgZGZAEmZhYWRgZWNpgwkGZlZWVnZODgZOBiZ+VmZWUE6wMhHl4+fgFBIbhKYRFRMXEJSSlpGVk5eQVFJWUGBhUGVTV1DU0tbR1dPX0DQyNjE1MGBnYGM3MLSytrG1s7ewdHJ2cXVzegfncPTy9vH18//4DAoOCQ0LBwoDqGiMio6JjYuPiExKTklNS09AygiQyZWdk5uXn5BYVFxSWlZeUVlTAXVDFU19TW1Tc0MoDdxwB2O8gvTc0MDGwtILdDVTIysLO3MrC2ofq+HTNAyAcAHTAkmSwMZ9UAAAAedEVYdGljYzpjb3B5cmlnaHQAR29vZ2xlIEluYy4gMjAxNqwLMzgAAAAUdEVYdGljYzpkZXNjcmlwdGlvbgBzUkdCupBzBwAAAABJRU5ErkJggg==" class="tab-icon" alt=""> Digimon</button>
            <button class="tab pokemon-singles" data-tab="pokemon-singles" onclick="switchTab('pokemon-singles')"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAUCAIAAAAyZ5t7AAABAGlDQ1BpY2MAABiVY2BgPMEABCwGDAy5eSVFQe5OChGRUQrsDxgYgRAMEpOLCxhwA6Cqb9cgai/r4lGHC3CmpBYnA+kPQKxSBLQcaKQIkC2SDmFrgNhJELYNiF1eUlACZAeA2EUhQc5AdgqQrZGOxE5CYicXFIHU9wDZNrk5pckIdzPwpOaFBgNpDiCWYShmCGJwZ3AC+R+iJH8RA4PFVwYG5gkIsaSZDAzbWxkYJG4hxFQWMDDwtzAwbDuPEEOESUFiUSJYiAWImdLSGBg+LWdg4I1kYBC+wMDAFQ0LCBxuUwC7zZ0hHwjTGXIYUoEingx5DMkMekCWEYMBgyGDGQCm1j8/yRb+6wAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAAB3RJTUUH6gIFCgY1O2vXZQAAAxRJREFUKM8FwUtvG0UcAPD5z8y+vN71I/bacezaSR0npKBUtFKBolaqBERIcOBD0CMfoB+AAxIXbhygBy49IFQkLoUSVAFVmtI20DwocpwQB7fr9fq13fXuzs7w+0Em20BQ4ZwjIEKAEEIgwICFEEIgBAgJhAmluEslpTX/2gf5gm5KImOqpZJppKjnzwgGQAIJrukpx4lv3fySIoQ0Uyw1U/NpkbPKmoolifiTcK5gMRarml6eL7p2cOsmo3EcKcn4k9Wt/zx9s3ft3eIdJyowP1UMj7lk/Dk+hzvtU/4GYAlTjEahum03WUwuZ++FMQYWpWXusiqw5FLm4bqxi1CScE65AAWH/wSvTGZ6rrqatWpIzh12XoyGYX/viU5evlqt2VwGwSgQCjwaz1SjcuXDjdfzaXz02/2KdLqfzf1oXegPxp22g4MeEohyLoxMnlLy1oVSTWNbn944Om6vTOyPl2vnLl3/qrc+7nWcw12BMI4itrxUuXb5bL1R7t794Zmk/3vxPffNjT0flze/eL81jH0bEwUAYQA0dAdWQZd5NKov28XG3qM/tKsb2o3Pu29/VDfCi8vK2DlECBHDaCZaLhHo/NqZhYoVe6PG4uJqc+lsrTpV9VDIayuNg7+7+zu7GAAAYPtp99etvdHY4xib2SwAIMSTGTPT5tQLy9acEIICYFU1ZDX9ze2tOIqtguK86KYUyXGnipblPP72+3vtzkiiFBNCU5oehCyRS1/ffvzzg/HAyw1nhpIqWqXSLw+OB+7UCxJCMBWIn19v6dGT/V4UFuftQGf9uFI3BkP/8aOd/rOdUr5wYhMAQREmi5X0FfL786LuhBmP1ICQePeuAzOLTs25lD0bbc7OAEowxhRzvz1ZOAjWMqbcku4nvqtQtqCcPPSvSrL0zsLTsj6JOKEsmjVXWrWlzzLPJywcTYKAnZwGZmE/CvWMvt2l3x3kXD+RKaYI45/u/FVfzPsB4wIEArvPUtrIcae9k+7YC12fJrECgGGuuMp4NWExYBBCAAClJGEMY0QoxYAABELAoqP/AThigbZSWxuQAAAAHnRFWHRpY2M6Y29weXJpZ2h0AEdvb2dsZSBJbmMuIDIwMTasCzM4AAAAFHRFWHRpY2M6ZGVzY3JpcHRpb24Ac1JHQrqQcwcAAAAASUVORK5CYII=" class="tab-icon" alt=""> Pok√©mon Singles</button>
            <button class="tab magic-singles" data-tab="magic-singles" onclick="switchTab('magic-singles')"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAUCAIAAAAyZ5t7AAABAGlDQ1BpY2MAABiVY2BgPMEABCwGDAy5eSVFQe5OChGRUQrsDxgYgRAMEpOLCxhwA6Cqb9cgai/r4lGHC3CmpBYnA+kPQKxSBLQcaKQIkC2SDmFrgNhJELYNiF1eUlACZAeA2EUhQc5AdgqQrZGOxE5CYicXFIHU9wDZNrk5pckIdzPwpOaFBgNpDiCWYShmCGJwZ3AC+R+iJH8RA4PFVwYG5gkIsaSZDAzbWxkYJG4hxFQWMDDwtzAwbDuPEEOESUFiUSJYiAWImdLSGBg+LWdg4I1kYBC+wMDAFQ0LCBxuUwC7zZ0hHwjTGXIYUoEingx5DMkMekCWEYMBgyGDGQCm1j8/yRb+6wAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAAB3RJTUUH6gIFCgY2omKG3wAAAlNJREFUKM8FwVuLXFUQBtDvq9rn0ufMrWfitAkkJqAgIojgi7/cd3+ADwOCYPKkMs4Mpu/dZ5+9q8q1+OGr2ylPSaBEBAJmEUq0iV2TQM7V+xYWQ5rL/PM3d8/7LOpuvujHsVtE0Dgtx5MqJPj1Xf/Lwy41iu1US6m14MMXqx/uu4s0F4vMm4+bq8P8eH/pz8cSoChRI2bIu9vVj6umi12uNTw3fvj2BmP68vNJpaGbJwpR8/j6u7u39w/r5977g14uEqbt7rKTuHq13i2H/Z8AUy1+Rv8+nWxxXYt8zvne1hZtlyheu9i9WqTp1HucU7i1w/LNKGn70WzRen3Tl1Gn3NEgLfZzf/0p99NcE4RXIquUY1ovA40yKtXYkB6BiIbWaEsiVY+LTlvOriqEBRJgERQFAohWaqeDOUUoY6tJAqCDUT2NYzMsULIglCAiDMUoAVpQRIIhYLnSmnPN9jy8LtXmagRn52yR3L1UdzA8DJYyGRFml7EjJQiQjgAhjeCQS3ZBREAWJslxDIm5dElaQXadam7VRZX76XwsqVEJRhZM9EF8aDE7BDzU5mV7FlBIzfPp3wNVhUAi4BHuQIRXVT4ewHpqVCUbTtV+f9pubRFupQbJpGIWSmxK/9d626gVQ0KEQ/47HX8bfrq9XpRqFLFaIiDS5tOZ9itVEEhCrHp9OdV//nhYj8vvV8NtV899M7efXg5dWTf0ISWQqVh4EBbHp6edP27+Hq76XonNdO45ETK5vr9Bno3v3i43+2OjQoKguVcPMJJQqB4gYG7XF+P/cBSC8KGhVZUAAAAedEVYdGljYzpjb3B5cmlnaHQAR29vZ2xlIEluYy4gMjAxNqwLMzgAAAAUdEVYdGljYzpkZXNjcmlwdGlvbgBzUkdCupBzBwAAAABJRU5ErkJggg==" class="tab-icon" alt=""> MTG Singles</button>
            <button class="tab wishlist" data-tab="wishlist" onclick="switchTab('wishlist')">‚ô° √ònskeliste</button>
        </div>
        <div class="tcg-section active" id="pokemon-section"><div class="type-grid" id="pokemon-types"></div><div id="pokemon-products" style="display:none;"><button class="back-btn" onclick="showTypes('pokemon')">‚Üê Tilbake</button><div class="product-grid" id="pokemon-product-grid"></div></div></div>
        <div class="tcg-section" id="magic-section"><div class="type-grid" id="magic-types"></div><div id="magic-products" style="display:none;"><button class="back-btn" onclick="showTypes('magic')">‚Üê Tilbake</button><div class="product-grid" id="magic-product-grid"></div></div></div>
        <div class="tcg-section" id="digimon-section"><div class="type-grid" id="digimon-types"></div><div id="digimon-products" style="display:none;"><button class="back-btn" onclick="showTypes('digimon')">‚Üê Tilbake</button><div class="product-grid" id="digimon-product-grid"></div></div></div>
        <div class="tcg-section" id="pokemon-singles-section"><div class="product-grid" id="pokemon-singles-grid"></div><div class="empty-state" id="pokemon-singles-empty" style="display:none;"><div class="empty-state-icon">üÉè</div><div class="empty-state-text">Ingen Pok√©mon-enkeltkort enn√•</div></div></div>
        <div class="tcg-section" id="magic-singles-section"><div class="product-grid" id="magic-singles-grid"></div><div class="empty-state" id="magic-singles-empty" style="display:none;"><div class="empty-state-icon">üÉè</div><div class="empty-state-text">Ingen MTG-enkeltkort enn√•</div></div></div>
        <div class="tcg-section" id="wishlist-section"><div class="product-grid" id="wishlist-grid"></div><div class="empty-state" id="wishlist-empty" style="display:none;"><div class="empty-state-icon">‚ô°</div><div class="empty-state-text">√ònskelisten er tom</div></div></div>
    </div>
    <div class="modal-overlay" id="modal">
        <div class="modal">
            <div class="modal-header"><h2 id="modal-title">Legg til produkt</h2><button class="modal-close" onclick="closeModal()">√ó</button></div>
            <div class="modal-body">
                <form id="product-form">
                    <input type="hidden" id="product-id">
                    <div class="form-row">
                        <div class="form-group"><label class="form-label">TCG</label><select class="form-select" id="product-tcg"><option value="pokemon">Pok√©mon</option><option value="magic">Magic</option><option value="digimon">Digimon</option><option value="pokemon-single">Pok√©mon Single</option><option value="magic-single">MTG Single</option></select></div>
                        <div class="form-group"><label class="form-label">Type</label><select class="form-select" id="product-type"><option value="booster">Booster Box</option><option value="etb">ETB</option><option value="collection">Collection Box</option><option value="case">Case</option><option value="tin">Tin</option><option value="blister">Blister</option><option value="bundle">Bundle</option><option value="display">Display</option><option value="single">Single</option><option value="other">Other</option></select></div>
                    </div>
                    <div class="form-group"><label class="form-label">Navn *</label><input type="text" class="form-input" id="product-name" required></div>
                    <div class="form-row">
                        <div class="form-group"><label class="form-label">Sett</label><input type="text" class="form-input" id="product-subtitle"></div>
                        <div class="form-group"><label class="form-label">Generasjon</label><input type="text" class="form-input" id="product-generation"></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label class="form-label">Antall</label><input type="number" class="form-input" id="product-quantity" min="1" value="1"></div>
                        <div class="form-group"><label class="form-label">Verdi (kr)</label><input type="number" class="form-input" id="product-value" min="0"></div>
                    </div>
                    <div class="form-group"><label class="form-label">Notater</label><textarea class="form-textarea" id="product-note"></textarea></div>
                    <div class="form-group"><label class="form-label">Bilde</label><div style="display:flex;gap:.5rem;margin-bottom:.5rem;"><button type="button" class="btn btn-secondary" style="flex:1;padding:.6rem;" onclick="document.getElementById('image-upload').click()">üì∑ Last opp</button><input type="file" id="image-upload" accept="image/*" style="display:none" onchange="handleImageUpload(event)"></div><input type="text" class="form-input" id="product-image" placeholder="Eller lim inn URL..."><img id="image-preview" style="display:none;max-width:100%;max-height:150px;margin-top:.75rem;border-radius:8px;"></div>
                    <div class="form-group"><label class="checkbox-group"><input type="checkbox" class="checkbox-input" id="product-wishlist"><span>√ònskeliste</span></label></div>
                </form>
            </div>
            <div class="modal-footer"><button class="btn btn-secondary" onclick="closeModal()">Avbryt</button><button class="btn btn-primary" onclick="saveProduct()">Lagre</button></div>
        </div>
    </div>
    <div class="lightbox-overlay" id="lightbox">
        <div class="lightbox-container">
            <button class="lightbox-close" onclick="closeLightbox()">√ó</button>
            <div class="lightbox-image-section">
                <div class="lightbox-badge" id="lightbox-badge">x1</div>
                <img id="lightbox-image" class="lightbox-image" src="" alt="">
            </div>
            <div class="lightbox-info">
                <div class="lightbox-header">
                    <div class="lightbox-generation" id="lightbox-generation"></div>
                    <div class="lightbox-name" id="lightbox-name"></div>
                    <div class="lightbox-subtitle" id="lightbox-subtitle"></div>
                </div>
                <div class="lightbox-meta">
                    <div class="lightbox-meta-item">
                        <div class="lightbox-meta-label">Antall</div>
                        <div class="lightbox-meta-value" id="lightbox-quantity">1</div>
                    </div>
                    <div class="lightbox-meta-item">
                        <div class="lightbox-meta-label">Verdi</div>
                        <div class="lightbox-meta-value" id="lightbox-value">‚Äî</div>
                    </div>
                </div>
                <div class="lightbox-description">
                    <div class="lightbox-description-label">
                        <span>üìù Beskrivelse / Notater</span>
                        <button class="lightbox-description-edit" id="lightbox-edit-btn" onclick="toggleDescriptionEdit()">Rediger</button>
                    </div>
                    <div id="lightbox-description-view">
                        <div class="lightbox-description-text" id="lightbox-description">Ingen beskrivelse lagt til enn√•.</div>
                    </div>
                    <div id="lightbox-description-edit" style="display:none;">
                        <textarea class="lightbox-description-textarea" id="lightbox-description-input" placeholder="Skriv inn beskrivelse, notater, tilstand, kj√∏psinformasjon..."></textarea>
                        <div class="lightbox-description-actions">
                            <button class="btn btn-primary" onclick="saveDescription()">Lagre</button>
                            <button class="btn btn-secondary" onclick="cancelDescriptionEdit()">Avbryt</button>
                        </div>
                    </div>
                </div>
                <div class="lightbox-links" id="lightbox-links"></div>
                <div class="lightbox-actions">
                    <button class="btn btn-secondary" style="flex:1" onclick="editProductFromLightbox()">‚úèÔ∏è Rediger produkt</button>
                    <button class="btn btn-secondary delete" style="flex:1" onclick="deleteProductFromLightbox()">üóëÔ∏è Slett</button>
                </div>
            </div>
        </div>
    </div>
    <script>
let products=[];
const typeNames={booster:{name:'Booster Boxes',icon:'BB'},etb:{name:'Elite Trainer Boxes',icon:'ETB'},collection:{name:'Collection Boxes',icon:'CB'},'case':{name:'Cases',icon:'CASE'},tin:{name:'Tins',icon:'TIN'},blister:{name:'Blisters',icon:'BP'},bundle:{name:'Bundles',icon:'BDL'},display:{name:'Displays',icon:'DSP'},single:{name:'Singles',icon:'üÉè'},other:{name:'Other',icon:'?'}};

// Digimon Card Game Logo som base64 PNG (fungerer garantert!)
const DIGIMON_LOGO='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMDAgODAiPjxkZWZzPjxsaW5lYXJHcmFkaWVudCBpZD0iZGciIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPjxzdG9wIG9mZnNldD0iMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiMwMGE4ZTgiLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiMwMDVhYTciLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48cmVjdCB4PSI1IiB5PSI1IiB3aWR0aD0iMTkwIiBoZWlnaHQ9IjcwIiByeD0iMTIiIGZpbGw9InVybCgjZGcpIi8+PHRleHQgeD0iMTAwIiB5PSI0NSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0id2hpdGUiIGZvbnQtZmFtaWx5PSJBcmlhbCBCbGFjaywgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIyNCIgZm9udC13ZWlnaHQ9ImJvbGQiPkRJR0lNT048L3RleHQ+PHRleHQgeD0iMTAwIiB5PSI2MiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0id2hpdGUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMCI+Q0FSRCBHQU1FPC90ZXh0Pjwvc3ZnPg==';

const initialProducts=[
    // Pokemon Sealed - SV
    {id:'1',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'Scarlet & Violet Booster Box',subtitle:'Base Set',quantity:2,type:'booster',image:'https://images.pokemontcg.io/sv1/logo.png',value:0,note:'',wishlist:false},
    {id:'2',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'Paldea Evolved Booster Box',subtitle:'Paldea Evolved',quantity:1,type:'booster',image:'https://images.pokemontcg.io/sv2/logo.png',value:0,note:'',wishlist:false},
    {id:'3',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'Obsidian Flames Booster Box',subtitle:'Obsidian Flames',quantity:1,type:'booster',image:'https://images.pokemontcg.io/sv3/logo.png',value:0,note:'',wishlist:false},
    {id:'4',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'Pokemon 151 Booster Box (JP)',subtitle:'Pokemon 151',quantity:1,type:'booster',image:'https://images.pokemontcg.io/sv3pt5/logo.png',value:0,note:'',wishlist:false},
    {id:'5',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'151 Elite Trainer Box',subtitle:'SV: 151',quantity:1,type:'etb',image:'https://images.pokemontcg.io/sv3pt5/logo.png',value:0,note:'',wishlist:false},
    {id:'6',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'151 Ultra-Premium Collection',subtitle:'SV: 151',quantity:1,type:'collection',image:'https://images.pokemontcg.io/sv3pt5/logo.png',value:0,note:'',wishlist:false},
    {id:'7',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'Paradox Rift Booster Box',subtitle:'Paradox Rift',quantity:2,type:'booster',image:'https://images.pokemontcg.io/sv4/logo.png',value:0,note:'',wishlist:false},
    {id:'8',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'Twilight Masquerade Booster Box',subtitle:'Twilight Masquerade',quantity:2,type:'booster',image:'https://images.pokemontcg.io/sv6/logo.png',value:0,note:'',wishlist:false},
    {id:'9',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'Surging Sparks Booster Box Case',subtitle:'Surging Sparks',quantity:1,type:'case',note:'x6 booster boxes',image:'https://images.pokemontcg.io/sv8/logo.png',value:0,wishlist:false},
    {id:'10',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'Journey Together Booster Box',subtitle:'Journey Together',quantity:6,type:'booster',image:'https://images.pokemontcg.io/sv9/logo.png',value:0,note:'',wishlist:false},
    {id:'11',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'Journey Together ETB Case',subtitle:'Journey Together',quantity:1,type:'case',note:'x10 ETBs',image:'https://images.pokemontcg.io/sv9/logo.png',value:0,wishlist:false},
    {id:'12',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'Destined Rivals Booster Box',subtitle:'Destined Rivals',quantity:3,type:'booster',image:'https://images.pokemontcg.io/sv10/logo.png',value:0,note:'',wishlist:false},
    {id:'17',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'Prismatic Evolutions ETB',subtitle:'Prismatic Evolutions',quantity:6,type:'etb',image:'https://images.pokemontcg.io/sv8pt5/logo.png',value:0,note:'',wishlist:false},
    {id:'18',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'Prismatic Evolutions Booster Bundle',subtitle:'Prismatic Evolutions',quantity:8,type:'bundle',image:'https://images.pokemontcg.io/sv8pt5/logo.png',value:0,note:'',wishlist:false},
    {id:'19',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'Prismatic Evolutions Surprise Box',subtitle:'Prismatic Evolutions',quantity:5,type:'collection',image:'https://images.pokemontcg.io/sv8pt5/logo.png',value:0,note:'',wishlist:false},
    {id:'20',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'Prismatic Evolutions Poster Collection',subtitle:'Prismatic Evolutions',quantity:1,type:'collection',image:'https://images.pokemontcg.io/sv8pt5/logo.png',value:0,note:'',wishlist:false},
    {id:'21',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'Prismatic Evolutions Binder Collection',subtitle:'Prismatic Evolutions',quantity:1,type:'collection',image:'https://images.pokemontcg.io/sv8pt5/logo.png',value:0,note:'',wishlist:false},
    {id:'22',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'Prismatic Evolutions Accessory Pouch',subtitle:'Prismatic Evolutions',quantity:1,type:'collection',image:'https://images.pokemontcg.io/sv8pt5/logo.png',value:0,note:'',wishlist:false},
    {id:'23',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'Prismatic Evolutions Mini Tin Display',subtitle:'Prismatic Evolutions',quantity:1,type:'display',image:'https://images.pokemontcg.io/sv8pt5/logo.png',value:0,note:'',wishlist:false},
    {id:'24',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'151 Binder Collection',subtitle:'SV: 151',quantity:2,type:'collection',image:'https://images.pokemontcg.io/sv3pt5/logo.png',value:0,note:'',wishlist:false},
    {id:'25',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'151 Booster Bundle',subtitle:'SV: 151',quantity:1,type:'bundle',image:'https://images.pokemontcg.io/sv3pt5/logo.png',value:0,note:'',wishlist:false},
    {id:'26',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'151: Zapdos ex Collection',subtitle:'SV: 151',quantity:3,type:'collection',image:'https://images.pokemontcg.io/sv3pt5/logo.png',value:0,note:'',wishlist:false},
    {id:'27',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'151: Alakazam ex Collection',subtitle:'SV: 151',quantity:3,type:'collection',image:'https://images.pokemontcg.io/sv3pt5/logo.png',value:0,note:'',wishlist:false},
    {id:'28',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'Stellar Crown ETB',subtitle:'Stellar Crown',quantity:2,type:'etb',image:'https://images.pokemontcg.io/sv7/logo.png',value:0,note:'',wishlist:false},
    {id:'29',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'Surging Sparks ETB',subtitle:'Surging Sparks',quantity:1,type:'etb',image:'https://images.pokemontcg.io/sv8/logo.png',value:0,note:'',wishlist:false},
    {id:'30',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'Twilight Masquerade ETB',subtitle:'Twilight Masquerade',quantity:2,type:'etb',image:'https://images.pokemontcg.io/sv6/logo.png',value:0,note:'',wishlist:false},
    {id:'31',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'Paradox Rift ETB [Iron Valiant]',subtitle:'Paradox Rift',quantity:1,type:'etb',image:'https://images.pokemontcg.io/sv4/logo.png',value:0,note:'',wishlist:false},
    {id:'32',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'Paradox Rift ETB [Roaring Moon]',subtitle:'Paradox Rift',quantity:1,type:'etb',image:'https://images.pokemontcg.io/sv4/logo.png',value:0,note:'',wishlist:false},
    {id:'44',tcg:'pokemon',generation:'Scarlet & Violet',generationOrder:9,name:'Combined Powers Premium Collection',subtitle:'Misc',quantity:2,type:'collection',image:'https://images.pokemontcg.io/sv4pt5/logo.png',value:0,note:'',wishlist:false},
    // Pokemon Sealed - SWSH
    {id:'13',tcg:'pokemon',generation:'Sword & Shield',generationOrder:8,name:'Silver Tempest Booster Box',subtitle:'Silver Tempest',quantity:1,type:'booster',image:'https://images.pokemontcg.io/swsh12/logo.png',value:0,note:'',wishlist:false},
    {id:'14',tcg:'pokemon',generation:'Sword & Shield',generationOrder:8,name:'Crown Zenith Elite Trainer Box',subtitle:'Crown Zenith',quantity:1,type:'etb',image:'https://images.pokemontcg.io/swsh12pt5/logo.png',value:0,note:'',wishlist:false},
    {id:'33',tcg:'pokemon',generation:'Sword & Shield',generationOrder:8,name:'Chilling Reign ETB [Shadow Rider]',subtitle:'Chilling Reign',quantity:2,type:'etb',image:'https://images.pokemontcg.io/swsh6/logo.png',value:0,note:'',wishlist:false},
    {id:'34',tcg:'pokemon',generation:'Sword & Shield',generationOrder:8,name:'Chilling Reign ETB [Ice Rider]',subtitle:'Chilling Reign',quantity:1,type:'etb',image:'https://images.pokemontcg.io/swsh6/logo.png',value:0,note:'',wishlist:false},
    {id:'35',tcg:'pokemon',generation:'Sword & Shield',generationOrder:8,name:'Chilling Reign 3-Pack Blister [Eevee]',subtitle:'Chilling Reign',quantity:2,type:'blister',image:'https://images.pokemontcg.io/swsh6/logo.png',value:0,note:'',wishlist:false},
    {id:'36',tcg:'pokemon',generation:'Sword & Shield',generationOrder:8,name:'Chilling Reign 3-Pack Blister [Snorlax]',subtitle:'Chilling Reign',quantity:2,type:'blister',image:'https://images.pokemontcg.io/swsh6/logo.png',value:0,note:'',wishlist:false},
    {id:'37',tcg:'pokemon',generation:'Sword & Shield',generationOrder:8,name:'Silver Tempest ETB',subtitle:'Silver Tempest',quantity:1,type:'etb',image:'https://images.pokemontcg.io/swsh12/logo.png',value:0,note:'',wishlist:false},
    {id:'38',tcg:'pokemon',generation:'Sword & Shield',generationOrder:8,name:'Lost Origin ETB',subtitle:'Lost Origin',quantity:1,type:'etb',image:'https://images.pokemontcg.io/swsh11/logo.png',value:0,note:'',wishlist:false},
    {id:'39',tcg:'pokemon',generation:'Sword & Shield',generationOrder:8,name:'Lost Abyss Booster Box (JP)',subtitle:'Lost Abyss',quantity:1,type:'booster',image:'https://images.pokemontcg.io/swsh11/logo.png',value:0,note:'',wishlist:false},
    {id:'40',tcg:'pokemon',generation:'Sword & Shield',generationOrder:8,name:'Fusion Strike 3-Pack Blister [Espeon]',subtitle:'Fusion Strike',quantity:2,type:'blister',image:'https://images.pokemontcg.io/swsh8/logo.png',value:0,note:'',wishlist:false},
    {id:'41',tcg:'pokemon',generation:'Sword & Shield',generationOrder:8,name:'Fusion Strike 3-Pack Blister [Eevee]',subtitle:'Fusion Strike',quantity:1,type:'blister',image:'https://images.pokemontcg.io/swsh8/logo.png',value:0,note:'',wishlist:false},
    {id:'42',tcg:'pokemon',generation:'Sword & Shield',generationOrder:8,name:'Brilliant Stars 3-Pack Blister [Glaceon]',subtitle:'Brilliant Stars',quantity:1,type:'blister',image:'https://images.pokemontcg.io/swsh9/logo.png',value:0,note:'',wishlist:false},
    {id:'43',tcg:'pokemon',generation:'Sword & Shield',generationOrder:8,name:'Brilliant Stars 3-Pack Blister [Leafeon]',subtitle:'Brilliant Stars',quantity:3,type:'blister',image:'https://images.pokemontcg.io/swsh9/logo.png',value:0,note:'',wishlist:false},
    // Pokemon Sealed - Classic
    {id:'15',tcg:'pokemon',generation:'Classic',generationOrder:1,name:'Team Rocket Attach√© Case (JP)',subtitle:'Glory of Team Rocket',quantity:1,type:'collection',image:'https://images.pokemontcg.io/base4/logo.png',value:0,note:'',wishlist:false},
    // Magic
    {id:'16',tcg:'magic',generation:'Fallen Empires',generationOrder:1,name:'Fallen Empires Booster Box',subtitle:'Fallen Empires',quantity:1,type:'booster',image:'https://svgs.scryfall.io/sets/fem.svg',value:0,note:'',wishlist:false},
    {id:'45',tcg:'magic',generation:'Return to Ravnica',generationOrder:2,name:'Return to Ravnica Booster Box',subtitle:'Return to Ravnica',quantity:1,type:'booster',image:'https://svgs.scryfall.io/sets/rtr.svg',value:0,note:'',wishlist:false},
    // Digimon - bruker DIGIMON_LOGO konstanten
    {id:'46',tcg:'digimon',generation:'Release Special',generationOrder:1,name:'Release Special Booster Ver.1.0 Box',subtitle:'BT01-03',quantity:2,type:'booster',image:'DIGIMON_LOGO',value:0,note:'',wishlist:false},
    {id:'47',tcg:'digimon',generation:'Release Special',generationOrder:1,name:'Release Special Booster Ver.1.5 Box',subtitle:'BT01-03',quantity:2,type:'booster',image:'DIGIMON_LOGO',value:0,note:'',wishlist:false},
    // Pokemon Singles - med RIKTIGE bilder fra pokemontcg.io API
    {id:'48',tcg:'pokemon-single',generation:'Prismatic Evolutions',generationOrder:9,name:'Bloodmoon Ursaluna ex',subtitle:'SIR ‚Ä¢ 168/131',quantity:1,type:'single',image:'https://images.pokemontcg.io/sv8pt5/168_hires.png',value:0,note:'',wishlist:false},
    {id:'49',tcg:'pokemon-single',generation:'Prismatic Evolutions',generationOrder:9,name:'Umbreon ex',subtitle:'Double Rare ‚Ä¢ 060/131',quantity:1,type:'single',image:'https://images.pokemontcg.io/sv8pt5/60_hires.png',value:0,note:'',wishlist:false},
    {id:'50',tcg:'pokemon-single',generation:'Prismatic Evolutions',generationOrder:9,name:"Larry's Skill",subtitle:'Ultra Rare ‚Ä¢ 139/131',quantity:1,type:'single',image:'https://images.pokemontcg.io/sv8pt5/139_hires.png',value:0,note:'',wishlist:false},
    {id:'51',tcg:'pokemon-single',generation:'Prismatic Evolutions',generationOrder:9,name:'Hoothoot (Poke Ball)',subtitle:'Common ‚Ä¢ 077/131',quantity:1,type:'single',image:'https://images.pokemontcg.io/sv8pt5/77_hires.png',value:0,note:'',wishlist:false},
    {id:'52',tcg:'pokemon-single',generation:'Prismatic Evolutions',generationOrder:9,name:'Groudon (Poke Ball)',subtitle:'Rare ‚Ä¢ 049/131',quantity:1,type:'single',image:'https://images.pokemontcg.io/sv8pt5/49_hires.png',value:0,note:'',wishlist:false},
    {id:'53',tcg:'pokemon-single',generation:'Journey Together',generationOrder:9,name:"Brock's Scouting",subtitle:'Ultra Rare ‚Ä¢ 179/159',quantity:1,type:'single',image:'https://images.pokemontcg.io/sv9/179_hires.png',value:0,note:'',wishlist:false},
    {id:'54',tcg:'pokemon-single',generation:'Journey Together',generationOrder:9,name:"Lillie's Ribombee",subtitle:'IR ‚Ä¢ 164/159',quantity:1,type:'single',image:'https://images.pokemontcg.io/sv9/164_hires.png',value:0,note:'',wishlist:false},
    {id:'55',tcg:'pokemon-single',generation:'Journey Together',generationOrder:9,name:'Lycanroc',subtitle:'IR ‚Ä¢ 166/159',quantity:1,type:'single',image:'https://images.pokemontcg.io/sv9/166_hires.png',value:0,note:'',wishlist:false},
    {id:'56',tcg:'pokemon-single',generation:'Destined Rivals',generationOrder:9,name:'Kangaskhan',subtitle:'IR ‚Ä¢ 204/182',quantity:1,type:'single',image:'https://images.pokemontcg.io/sv10/204_hires.png',value:0,note:'',wishlist:false},
    {id:'57',tcg:'pokemon-single',generation:'SV: White Flare',generationOrder:9,name:'Deino',subtitle:'IR ‚Ä¢ 146/086',quantity:1,type:'single',image:'https://images.pokemontcg.io/sv8a/146_hires.png',value:0,note:'',wishlist:false},
    {id:'58',tcg:'pokemon-single',generation:'SV Promo',generationOrder:9,name:'Kingdra ex',subtitle:'Promo ‚Ä¢ SVP 131',quantity:3,type:'single',image:'https://images.pokemontcg.io/svp/131_hires.png',value:0,note:'',wishlist:false},
    {id:'59',tcg:'pokemon-single',generation:'SV Promo',generationOrder:9,name:'Greninja ex',subtitle:'Promo ‚Ä¢ SVP 132',quantity:1,type:'single',image:'https://images.pokemontcg.io/svp/132_hires.png',value:0,note:'',wishlist:false},
    {id:'60',tcg:'pokemon-single',generation:'Sun & Moon Promo',generationOrder:7,name:'Moltres & Zapdos & Articuno GX',subtitle:'Promo ‚Ä¢ SM210',quantity:1,type:'single',image:'https://images.pokemontcg.io/smp/SM210_hires.png',value:0,note:'',wishlist:false},
    // Nye kort
    {id:'61',tcg:'pokemon-single',generation:'Prismatic Evolutions',generationOrder:9,name:'Treasure Tracker',subtitle:'ACE SPEC ‚Ä¢ 131/131',quantity:1,type:'single',image:'https://images.pokemontcg.io/sv8pt5/131_hires.png',value:0,note:'',wishlist:false},
    {id:'62',tcg:'magic-single',generation:'Assassins Creed',generationOrder:1,name:'Mary Read and Anne Bonny',subtitle:'Double Rainbow Serial ‚Ä¢ CGC 10 Pristine',quantity:1,type:'single',image:'https://ccg-imaging-cgc-tradingcards-production.s3.amazonaws.com/6e376c52-397a-4638-85d3-76a3a153fe03/CRD1401039830-170_OBV@500x830.jpg',value:0,note:'CGC Cert #1401039830170',cgcLink:'https://www.cgccards.com/CERTLOOKUP/1401039830170/10_0/',wishlist:false},
];

function loadData(){const s=localStorage.getItem('tcg-collection-v8');if(s){products=JSON.parse(s)}else{products=initialProducts;saveData()}updateUI()}
function saveData(){localStorage.setItem('tcg-collection-v8',JSON.stringify(products))}
function updateUI(){updateStats();renderTypes('pokemon');renderTypes('magic');renderTypes('digimon');renderSingles('pokemon-singles');renderSingles('magic-singles');renderWishlist()}
function updateStats(){const o=products.filter(p=>!p.wishlist);const si=products.filter(p=>(p.tcg==='pokemon-single'||p.tcg==='magic-single')&&!p.wishlist);const se=o.filter(p=>p.tcg!=='pokemon-single'&&p.tcg!=='magic-single');document.getElementById('totalProducts').textContent=se.length;document.getElementById('totalItems').textContent=se.reduce((s,p)=>s+p.quantity,0);const tv=o.reduce((s,p)=>s+(p.value||0)*p.quantity,0);document.getElementById('totalValue').textContent=tv>0?tv.toLocaleString('nb-NO')+' kr':'‚Äî';document.getElementById('singlesCount').textContent=si.reduce((s,p)=>s+p.quantity,0);document.getElementById('wishlistCount').textContent=products.filter(p=>p.wishlist).length}
function switchTab(t){document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));document.querySelector('.tab[data-tab="'+t+'"]').classList.add('active');document.querySelectorAll('.tcg-section').forEach(x=>x.classList.remove('active'));document.getElementById(t+'-section').classList.add('active');if(['pokemon','magic','digimon'].includes(t))showTypes(t)}
function renderTypes(tcg){const p=products.filter(x=>x.tcg===tcg&&!x.wishlist);const c=document.getElementById(tcg+'-types');const g={};p.forEach(x=>{if(!g[x.type])g[x.type]=[];g[x.type].push(x)});c.innerHTML='';if(Object.keys(g).length===0){const ic={pokemon:'‚ö°',magic:'‚úß',digimon:'üî∑'};c.innerHTML='<div class="empty-state" style="grid-column:1/-1;"><div class="empty-state-icon">'+ic[tcg]+'</div><div class="empty-state-text">Ingen produkter enn√•</div></div>';return}Object.keys(g).forEach(t=>{const i=typeNames[t]||{name:t,icon:'?'};const cnt=g[t].reduce((s,x)=>s+x.quantity,0);const d=document.createElement('div');d.className='type-card '+tcg;d.onclick=()=>showProducts(tcg,t);d.innerHTML='<div class="type-icon">'+i.icon+'</div><div class="type-name">'+i.name+'</div><div class="type-count">'+cnt+' stk</div>';c.appendChild(d)})}
function showTypes(tcg){document.getElementById(tcg+'-types').style.display='grid';document.getElementById(tcg+'-products').style.display='none'}
function showProducts(tcg,type){document.getElementById(tcg+'-types').style.display='none';document.getElementById(tcg+'-products').style.display='block';const f=products.filter(p=>p.tcg===tcg&&p.type===type&&!p.wishlist);f.sort((a,b)=>(b.generationOrder||0)-(a.generationOrder||0));const g={};f.forEach(p=>{const k=p.generation||'Ukjent';if(!g[k])g[k]=[];g[k].push(p)});const c=document.getElementById(tcg+'-product-grid');c.innerHTML='';Object.entries(g).forEach(([gen,ps])=>{const h=document.createElement('div');h.className='generation-header';h.textContent=gen;c.appendChild(h);ps.forEach(p=>c.appendChild(createProductCard(p)))})}
function renderSingles(section){const tcg=section==='pokemon-singles'?'pokemon-single':'magic-single';const p=products.filter(x=>x.tcg===tcg&&!x.wishlist);const c=document.getElementById(section+'-grid');const e=document.getElementById(section+'-empty');if(p.length===0){c.style.display='none';e.style.display='block';return}c.style.display='grid';e.style.display='none';c.innerHTML='';const g={};p.forEach(x=>{const k=x.generation||'Ukjent';if(!g[k])g[k]=[];g[k].push(x)});Object.entries(g).forEach(([gen,ps])=>{const h=document.createElement('div');h.className='generation-header';h.textContent=gen;c.appendChild(h);ps.forEach(x=>c.appendChild(createProductCard(x)))})}
function renderWishlist(){const p=products.filter(x=>x.wishlist);const c=document.getElementById('wishlist-grid');const e=document.getElementById('wishlist-empty');if(p.length===0){c.style.display='none';e.style.display='block';return}c.style.display='grid';e.style.display='none';c.innerHTML='';p.forEach(x=>c.appendChild(createProductCard(x,true)))}
function getImageHTML(p){
    // Digimon logo
    if(p.image==='DIGIMON_LOGO'||p.tcg==='digimon'&&!p.image){
        return '<img src="'+DIGIMON_LOGO+'" alt="Digimon" class="product-image" style="max-height:80px;">';
    }
    // Vanlig bilde
    if(p.image&&p.image.length>10){
        return '<img src="'+p.image+'" alt="" class="product-image" onerror="this.style.display=\'none\';this.parentElement.innerHTML+=\'<div style=color:var(--text-muted);font-size:2.5rem;opacity:.5>üì¶</div>\'">';
    }
    // Placeholder
    if(p.tcg==='pokemon-single'||p.tcg==='magic-single'){
        return '<div style="color:var(--text-muted);font-size:3rem;opacity:.5;">üÉè</div>';
    }
    return '<div style="color:var(--text-muted);font-size:2.5rem;opacity:.5;">üì¶</div>';
}
function createProductCard(p,isWishlist=false){const c=document.createElement('div');c.className='product-card '+p.tcg+(isWishlist?' wishlist-item':'');const sn=encodeURIComponent(p.name);let links='';if(p.tcg.includes('pokemon')){links='<a href="https://www.cardmarket.com/en/Pokemon/Products/search?searchString='+sn+'" target="_blank" class="price-link">Cardmarket</a><a href="https://www.tcgplayer.com/search/pokemon/product?q='+sn+'" target="_blank" class="price-link">TCGPlayer</a>'}else if(p.tcg.includes('magic')){links='<a href="https://www.cardmarket.com/en/Magic/Products/search?searchString='+sn+'" target="_blank" class="price-link">Cardmarket</a><a href="https://www.tcgplayer.com/search/magic/product?q='+sn+'" target="_blank" class="price-link">TCGPlayer</a>'}else if(p.tcg==='digimon'){links='<a href="https://www.cardmarket.com/en/Digimon/Products/search?searchString='+sn+'" target="_blank" class="price-link">Cardmarket</a>'}if(p.cgcLink){links+='<a href="'+p.cgcLink+'" target="_blank" class="price-link" style="background:rgba(0,200,100,.15);color:#00c864;">CGC Cert</a>'}c.innerHTML='<div class="product-image-container" onclick="openLightbox(\''+p.id+'\')" style="cursor:pointer">'+getImageHTML(p)+'<div class="product-badge '+(isWishlist?'wishlist':p.tcg)+'">'+(isWishlist?'‚ô°':'x'+p.quantity)+'</div></div><div class="product-content"><div class="product-generation">'+(p.generation||p.tcg)+'</div><div class="product-name">'+p.name+'</div><div class="product-subtitle">'+(p.subtitle||'')+'</div>'+(p.note?'<div class="product-note">'+p.note+'</div>':'')+'<div class="product-meta"><div class="product-quantity">Antall: '+p.quantity+'</div><div class="product-value">'+(p.value?p.value.toLocaleString('nb-NO')+' kr':'‚Äî')+'</div></div><div class="price-links">'+links+'</div><div class="product-actions"><button class="btn-small" onclick="editProduct(\''+p.id+'\')">Rediger</button>'+(isWishlist?'<button class="btn-small" onclick="moveToCollection(\''+p.id+'\')">‚úì Kj√∏pt</button>':'')+'<button class="btn-small delete" onclick="deleteProduct(\''+p.id+'\')">Slett</button></div></div>';return c}
function openAddModal(isWishlist=false){document.getElementById('modal-title').textContent=isWishlist?'Legg til i √∏nskeliste':'Legg til produkt';document.getElementById('product-form').reset();document.getElementById('product-id').value='';document.getElementById('product-wishlist').checked=isWishlist;document.getElementById('image-preview').style.display='none';document.getElementById('modal').classList.add('active')}
function closeModal(){document.getElementById('modal').classList.remove('active')}
function editProduct(id){const p=products.find(x=>x.id===id);if(!p)return;document.getElementById('modal-title').textContent='Rediger produkt';document.getElementById('product-id').value=p.id;document.getElementById('product-tcg').value=p.tcg;document.getElementById('product-type').value=p.type;document.getElementById('product-name').value=p.name;document.getElementById('product-subtitle').value=p.subtitle||'';document.getElementById('product-generation').value=p.generation||'';document.getElementById('product-quantity').value=p.quantity;document.getElementById('product-value').value=p.value||'';document.getElementById('product-note').value=p.note||'';document.getElementById('product-image').value=(p.image==='DIGIMON_LOGO'?'':p.image)||'';document.getElementById('product-wishlist').checked=p.wishlist||false;const pr=document.getElementById('image-preview');if(p.image&&p.image!=='DIGIMON_LOGO'){pr.src=p.image;pr.style.display='block'}else{pr.style.display='none'}document.getElementById('modal').classList.add('active')}
function handleImageUpload(e){const f=e.target.files[0];if(!f)return;const r=new FileReader();r.onload=function(ev){const b=ev.target.result;document.getElementById('product-image').value=b;document.getElementById('image-preview').src=b;document.getElementById('image-preview').style.display='block'};r.readAsDataURL(f)}
function saveProduct(){const id=document.getElementById('product-id').value||Date.now().toString();const tcg=document.getElementById('product-tcg').value;let img=document.getElementById('product-image').value;if(tcg==='digimon'&&!img)img='DIGIMON_LOGO';const p={id:id,tcg:tcg,type:document.getElementById('product-type').value,name:document.getElementById('product-name').value,subtitle:document.getElementById('product-subtitle').value,generation:document.getElementById('product-generation').value,generationOrder:getGenOrder(document.getElementById('product-generation').value),quantity:parseInt(document.getElementById('product-quantity').value)||1,value:parseFloat(document.getElementById('product-value').value)||0,note:document.getElementById('product-note').value,image:img,wishlist:document.getElementById('product-wishlist').checked};const idx=products.findIndex(x=>x.id===id);if(idx>=0)products[idx]=p;else products.push(p);saveData();updateUI();closeModal()}
function getGenOrder(g){const o={'Scarlet & Violet':9,'Prismatic Evolutions':9,'Journey Together':9,'Destined Rivals':9,'SV Promo':9,'SV: White Flare':9,'Sword & Shield':8,'Sun & Moon':7,'Sun & Moon Promo':7,'XY':6,'Black & White':5,'Classic':1,'Release Special':1,'Return to Ravnica':2,'Fallen Empires':1,'Assassins Creed':1};return o[g]||0}
function deleteProduct(id){if(!confirm('Slette?'))return;products=products.filter(p=>p.id!==id);saveData();updateUI()}
function moveToCollection(id){const p=products.find(x=>x.id===id);if(p){p.wishlist=false;saveData();updateUI()}}
function exportData(){const b=new Blob([JSON.stringify(products,null,2)],{type:'application/json'});const a=document.createElement('a');a.href=URL.createObjectURL(b);a.download='tcg-samling-'+new Date().toISOString().split('T')[0]+'.json';a.click()}
function importData(e){const f=e.target.files[0];if(!f)return;const r=new FileReader();r.onload=function(ev){try{const i=JSON.parse(ev.target.result);if(Array.isArray(i)&&confirm('Importere '+i.length+' produkter?')){products=i;saveData();updateUI();alert('Importert!')}}catch(err){alert('Feil')}};r.readAsText(f);e.target.value=''}
document.getElementById('modal').addEventListener('click',function(e){if(e.target===this)closeModal()});
document.addEventListener('keydown',function(e){if(e.key==='Escape'){closeModal();closeLightbox()}});
let currentLightboxId=null;
function openLightbox(id){
    const p=products.find(x=>x.id===id);
    if(!p)return;
    currentLightboxId=id;
    // Sett bilde
    const imgEl=document.getElementById('lightbox-image');
    if(p.image==='DIGIMON_LOGO'||p.tcg==='digimon'&&!p.image){
        imgEl.src=DIGIMON_LOGO;
        imgEl.style.maxHeight='120px';
    }else if(p.image&&p.image.length>10){
        imgEl.src=p.image;
        imgEl.style.maxHeight='400px';
    }else{
        imgEl.src='';
        imgEl.style.display='none';
    }
    // Badge
    const badge=document.getElementById('lightbox-badge');
    badge.textContent='x'+p.quantity;
    badge.className='lightbox-badge '+p.tcg;
    // Info
    document.getElementById('lightbox-generation').textContent=p.generation||p.tcg;
    document.getElementById('lightbox-name').textContent=p.name;
    document.getElementById('lightbox-subtitle').textContent=p.subtitle||'';
    document.getElementById('lightbox-quantity').textContent=p.quantity;
    document.getElementById('lightbox-value').textContent=p.value?p.value.toLocaleString('nb-NO')+' kr':'‚Äî';
    // Beskrivelse
    const desc=p.description||p.note||'';
    document.getElementById('lightbox-description').textContent=desc||'Ingen beskrivelse lagt til enn√•. Klikk "Rediger" for √• legge til.';
    document.getElementById('lightbox-description-input').value=desc;
    document.getElementById('lightbox-description-view').style.display='block';
    document.getElementById('lightbox-description-edit').style.display='none';
    document.getElementById('lightbox-edit-btn').textContent='Rediger';
    // Lenker
    const sn=encodeURIComponent(p.name);
    let linksHtml='';
    if(p.tcg.includes('pokemon')){
        linksHtml='<a href="https://www.cardmarket.com/en/Pokemon/Products/search?searchString='+sn+'" target="_blank" class="lightbox-link">üõí Cardmarket</a><a href="https://www.tcgplayer.com/search/pokemon/product?q='+sn+'" target="_blank" class="lightbox-link">üõí TCGPlayer</a>';
    }else if(p.tcg.includes('magic')){
        linksHtml='<a href="https://www.cardmarket.com/en/Magic/Products/search?searchString='+sn+'" target="_blank" class="lightbox-link">üõí Cardmarket</a><a href="https://www.tcgplayer.com/search/magic/product?q='+sn+'" target="_blank" class="lightbox-link">üõí TCGPlayer</a>';
    }else if(p.tcg==='digimon'){
        linksHtml='<a href="https://www.cardmarket.com/en/Digimon/Products/search?searchString='+sn+'" target="_blank" class="lightbox-link">üõí Cardmarket</a>';
    }
    if(p.cgcLink){
        linksHtml+='<a href="'+p.cgcLink+'" target="_blank" class="lightbox-link" style="background:rgba(0,200,100,.15);color:#00c864;">üèÜ CGC Cert</a>';
    }
    document.getElementById('lightbox-links').innerHTML=linksHtml;
    document.getElementById('lightbox').classList.add('active');
    document.body.style.overflow='hidden';
}
function closeLightbox(){
    document.getElementById('lightbox').classList.remove('active');
    document.body.style.overflow='';
    currentLightboxId=null;
}
function toggleDescriptionEdit(){
    const viewEl=document.getElementById('lightbox-description-view');
    const editEl=document.getElementById('lightbox-description-edit');
    const btn=document.getElementById('lightbox-edit-btn');
    if(editEl.style.display==='none'){
        viewEl.style.display='none';
        editEl.style.display='block';
        btn.textContent='Avbryt';
        document.getElementById('lightbox-description-input').focus();
    }else{
        cancelDescriptionEdit();
    }
}
function cancelDescriptionEdit(){
    document.getElementById('lightbox-description-view').style.display='block';
    document.getElementById('lightbox-description-edit').style.display='none';
    document.getElementById('lightbox-edit-btn').textContent='Rediger';
    const p=products.find(x=>x.id===currentLightboxId);
    if(p)document.getElementById('lightbox-description-input').value=p.description||p.note||'';
}
function saveDescription(){
    if(!currentLightboxId)return;
    const p=products.find(x=>x.id===currentLightboxId);
    if(!p)return;
    const newDesc=document.getElementById('lightbox-description-input').value.trim();
    p.description=newDesc;
    saveData();
    document.getElementById('lightbox-description').textContent=newDesc||'Ingen beskrivelse lagt til enn√•. Klikk "Rediger" for √• legge til.';
    document.getElementById('lightbox-description-view').style.display='block';
    document.getElementById('lightbox-description-edit').style.display='none';
    document.getElementById('lightbox-edit-btn').textContent='Rediger';
    updateUI();
}
function editProductFromLightbox(){
    if(!currentLightboxId)return;
    closeLightbox();
    editProduct(currentLightboxId);
}
function deleteProductFromLightbox(){
    if(!currentLightboxId)return;
    if(!confirm('Er du sikker p√• at du vil slette dette produktet?'))return;
    products=products.filter(p=>p.id!==currentLightboxId);
    saveData();
    updateUI();
    closeLightbox();
}
document.getElementById('lightbox').addEventListener('click',function(e){if(e.target===this)closeLightbox()});
loadData();
    </script>
</body>
</html>
